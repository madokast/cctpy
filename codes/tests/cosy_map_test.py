import unittest

from cctpy.baseutils import Stream, Equal
from cctpy.constant import MM
from cctpy.cosy import CosyMap
from cctpy.particle import PhaseSpaceParticle


class MyTestCase(unittest.TestCase):
    def test_something(self):
        map = CosyMap("""  0.9204298      2.342948     0.0000000E+00 0.0000000E+00 0.2875828E-01 100000
 -0.1511535     0.7016887     0.0000000E+00 0.0000000E+00-0.5728590E-02 010000
  0.0000000E+00 0.0000000E+00 0.7342880     0.8951463     0.0000000E+00 001000
  0.0000000E+00 0.0000000E+00-0.3362275     0.9519796     0.0000000E+00 000100
  0.0000000E+00 0.0000000E+00 0.0000000E+00 0.0000000E+00  1.000000     000010
 -0.9258508E-03-0.3360115E-01 0.0000000E+00 0.0000000E+00  2.053380     000001
   4.885144      28.34025     0.0000000E+00 0.0000000E+00-0.3071154     200000
   15.06786      21.59868     0.0000000E+00 0.0000000E+00 0.8201890     110000
 -0.3743387     -8.469834     0.0000000E+00 0.0000000E+00 0.2712384E-01 020000
  0.0000000E+00 0.0000000E+00  47.42200     -18.29999     0.0000000E+00 101000
  0.0000000E+00 0.0000000E+00  20.27668     -8.717686     0.0000000E+00 011000
   15.52291      9.154235     0.0000000E+00 0.0000000E+00 -1.067533     002000
  0.0000000E+00 0.0000000E+00  18.80651     -30.17513     0.0000000E+00 100100
  0.0000000E+00 0.0000000E+00 0.4577091     -21.73826     0.0000000E+00 010100
   20.96289      10.99831     0.0000000E+00 0.0000000E+00 0.7893651E-02 001100
  0.1727875      1.406819     0.0000000E+00 0.0000000E+00-0.7117329E-01 100001
  0.1091187    -0.8499203E-01 0.0000000E+00 0.0000000E+00-0.2705320E-02 010001
  0.0000000E+00 0.0000000E+00 -1.566856      2.395144     0.0000000E+00 001001
  -2.576880     -10.77361     0.0000000E+00 0.0000000E+00-0.3607443     000200
  0.0000000E+00 0.0000000E+00-0.6480240     0.1446635     0.0000000E+00 000101
 -0.8688021E-02 0.1899410E-01 0.0000000E+00 0.0000000E+00 -1.892372     000002
  -797.0295     -96.55657     0.0000000E+00 0.0000000E+00 -51.13967     300000
  -1179.201     -432.6189     0.0000000E+00 0.0000000E+00 -52.18501     210000
  -685.8243     -708.8992     0.0000000E+00 0.0000000E+00 -16.96513     120000
  -217.8797     -254.9463     0.0000000E+00 0.0000000E+00 -6.652174     030000
  0.0000000E+00 0.0000000E+00  2906.779      652.1254     0.0000000E+00 201000
  0.0000000E+00 0.0000000E+00  2029.305      575.5792     0.0000000E+00 111000
  0.0000000E+00 0.0000000E+00  126.3083      237.6345     0.0000000E+00 021000
   680.7857      284.9838     0.0000000E+00 0.0000000E+00 -67.97312     102000
   251.4978      120.3974     0.0000000E+00 0.0000000E+00 -25.05416     012000
  0.0000000E+00 0.0000000E+00  103.1423     -41.66030     0.0000000E+00 003000
  0.0000000E+00 0.0000000E+00  2606.710      590.6888     0.0000000E+00 200100
  0.0000000E+00 0.0000000E+00  1336.176      736.8877     0.0000000E+00 110100
  0.0000000E+00 0.0000000E+00  34.35928      364.1676     0.0000000E+00 020100
   1854.990      587.5165     0.0000000E+00 0.0000000E+00 -41.59704     101100
   408.9860      154.7060     0.0000000E+00 0.0000000E+00 -1.290977     011100
  0.0000000E+00 0.0000000E+00  208.8665     -31.64033     0.0000000E+00 002100
  -6.344459      59.24166     0.0000000E+00 0.0000000E+00  18.79133     200001
   6.020431      32.13839     0.0000000E+00 0.0000000E+00  14.57900     110001
   3.224877      6.268984     0.0000000E+00 0.0000000E+00  3.044752     020001
  0.0000000E+00 0.0000000E+00 -76.03886     -16.77605     0.0000000E+00 101001
  0.0000000E+00 0.0000000E+00 -49.60650     -10.74272     0.0000000E+00 011001
  0.5346831      7.527031     0.0000000E+00 0.0000000E+00  12.38693     002001
   1194.301      83.92642     0.0000000E+00 0.0000000E+00  64.57250     100200
   178.9343     -39.62327     0.0000000E+00 0.0000000E+00  13.67199     010200
  0.0000000E+00 0.0000000E+00  130.3576      293.8730     0.0000000E+00 001200
  0.0000000E+00 0.0000000E+00 -6.104951      102.5838     0.0000000E+00 100101
  0.0000000E+00 0.0000000E+00 -3.974531      23.19271     0.0000000E+00 010101
  -63.26682     -40.86532     0.0000000E+00 0.0000000E+00  21.01019     001101
   10.12700      4.334550     0.0000000E+00 0.0000000E+00-0.3924230E-01 100002
   3.707241      1.187368     0.0000000E+00 0.0000000E+00 0.9770301E-02 010002
  0.0000000E+00 0.0000000E+00  12.76915     -2.307577     0.0000000E+00 001002
  0.0000000E+00 0.0000000E+00  307.3727      452.8350     0.0000000E+00 000300
  -4.726842     -20.38336     0.0000000E+00 0.0000000E+00  16.63024     000201
  0.0000000E+00 0.0000000E+00  16.37677      2.661159     0.0000000E+00 000102
 -0.5142238E-01-0.6135132E-02 0.0000000E+00 0.0000000E+00  1.762705     000003
  -6244.844     -4188.357     0.0000000E+00 0.0000000E+00 -1228.809     400000
  -5451.411     -8738.913     0.0000000E+00 0.0000000E+00 -1521.005     310000
   12470.42     -6169.308     0.0000000E+00 0.0000000E+00  140.9155     220000
   12575.26     -92.73620     0.0000000E+00 0.0000000E+00  412.4666     130000
   3002.432      1534.098     0.0000000E+00 0.0000000E+00  56.95713     040000
  0.0000000E+00 0.0000000E+00  71635.62      22230.88     0.0000000E+00 301000
  0.0000000E+00 0.0000000E+00  61206.18      23348.60     0.0000000E+00 211000
  0.0000000E+00 0.0000000E+00 -15333.03      1854.025     0.0000000E+00 121000
  0.0000000E+00 0.0000000E+00 -10380.97     -1475.190     0.0000000E+00 031000
  -11477.08     -3624.832     0.0000000E+00 0.0000000E+00 -6946.682     202000
  -15520.59     -4125.748     0.0000000E+00 0.0000000E+00 -5066.296     112000
  -6965.047     -2165.210     0.0000000E+00 0.0000000E+00 -600.1663     022000
  0.0000000E+00 0.0000000E+00  14118.17      1664.035     0.0000000E+00 103000
  0.0000000E+00 0.0000000E+00  5520.337      600.2018     0.0000000E+00 013000
   1830.741      648.9129     0.0000000E+00 0.0000000E+00 -247.9355     004000
  0.0000000E+00 0.0000000E+00  72756.79      18684.66     0.0000000E+00 300100
  0.0000000E+00 0.0000000E+00  37632.34      12279.35     0.0000000E+00 210100
  0.0000000E+00 0.0000000E+00 -28249.39     -4282.864     0.0000000E+00 120100
  0.0000000E+00 0.0000000E+00 -8958.878     -3364.064     0.0000000E+00 030100
  -8395.211     -3057.664     0.0000000E+00 0.0000000E+00 -14504.10     201100
  -31625.56     -6532.423     0.0000000E+00 0.0000000E+00 -9557.451     111100
  -18420.88     -3826.847     0.0000000E+00 0.0000000E+00 -1340.012     021100
  0.0000000E+00 0.0000000E+00  26640.77     -1078.209     0.0000000E+00 102100
  0.0000000E+00 0.0000000E+00  9261.612     -531.3176     0.0000000E+00 012100
   9026.984      3601.400     0.0000000E+00 0.0000000E+00 -710.7056     003100
  -2726.676      85.08376     0.0000000E+00 0.0000000E+00  223.9421     300001
  -2653.320     -269.1689     0.0000000E+00 0.0000000E+00  167.7071     210001
  -541.9313     -420.7670     0.0000000E+00 0.0000000E+00 -174.1346     120001
   40.12787     -61.13530     0.0000000E+00 0.0000000E+00 -75.09170     030001
  0.0000000E+00 0.0000000E+00 -5489.523     -1844.479     0.0000000E+00 201001
  0.0000000E+00 0.0000000E+00 -6297.592     -1712.865     0.0000000E+00 111001
  0.0000000E+00 0.0000000E+00 -1032.462     -380.0584     0.0000000E+00 021001
   836.6016      387.1534     0.0000000E+00 0.0000000E+00  133.2199     102001
  -91.32184     -25.37364     0.0000000E+00 0.0000000E+00  52.12548     012001
  0.0000000E+00 0.0000000E+00 -456.4088      78.52101     0.0000000E+00 003001
   11762.09      1067.726     0.0000000E+00 0.0000000E+00 -7049.794     200200
  -13003.56     -1742.409     0.0000000E+00 0.0000000E+00 -4945.996     110200
  -9872.036      744.6892     0.0000000E+00 0.0000000E+00 -1325.793     020200
  0.0000000E+00 0.0000000E+00 -10616.77     -17235.75     0.0000000E+00 101200
  0.0000000E+00 0.0000000E+00 -5208.763     -8941.145     0.0000000E+00 011200
   15359.39      7462.531     0.0000000E+00 0.0000000E+00 -572.4739     002200
  0.0000000E+00 0.0000000E+00 -8588.121     -3920.342     0.0000000E+00 200101
  0.0000000E+00 0.0000000E+00 -7064.726     -3374.686     0.0000000E+00 110101
  0.0000000E+00 0.0000000E+00 -1350.612     -1547.889     0.0000000E+00 020101
  -2362.907     -1030.490     0.0000000E+00 0.0000000E+00  124.4395     101101
  -1964.314     -1064.810     0.0000000E+00 0.0000000E+00 -269.9114     011101
  0.0000000E+00 0.0000000E+00 -1299.355      1310.482     0.0000000E+00 002101
  -60.60866     -28.56919     0.0000000E+00 0.0000000E+00 -31.64450     200002
  -101.5502     -91.64918     0.0000000E+00 0.0000000E+00 -31.24417     110002
  -91.29221     -55.01080     0.0000000E+00 0.0000000E+00 -7.695720     020002
  0.0000000E+00 0.0000000E+00  442.0123      254.0249     0.0000000E+00 101002
  0.0000000E+00 0.0000000E+00  174.9425      77.80741     0.0000000E+00 011002
   41.48541      9.498526     0.0000000E+00 0.0000000E+00 -1.188670     002002
  0.0000000E+00 0.0000000E+00 -15731.38     -17471.45     0.0000000E+00 100300
  0.0000000E+00 0.0000000E+00 -4030.052     -9924.188     0.0000000E+00 010300
   11655.01      8391.371     0.0000000E+00 0.0000000E+00 -366.1533     001300
  -5058.711     -2133.199     0.0000000E+00 0.0000000E+00 -547.6290     100201
  -2104.874     -1186.718     0.0000000E+00 0.0000000E+00 -444.6354     010201
  0.0000000E+00 0.0000000E+00  19.22801      2853.822     0.0000000E+00 001201
  0.0000000E+00 0.0000000E+00  438.7239     -40.13488     0.0000000E+00 100102
  0.0000000E+00 0.0000000E+00  71.70591     -10.57024     0.0000000E+00 010102
   504.0647      182.8720     0.0000000E+00 0.0000000E+00 -4.418250     001102
  -8.186259      1.841879     0.0000000E+00 0.0000000E+00  2.452925     100003
  -5.175391    -0.3432384     0.0000000E+00 0.0000000E+00 0.8866104     010003
  0.0000000E+00 0.0000000E+00  1.509245      15.25913     0.0000000E+00 001003
   2443.741      4258.919     0.0000000E+00 0.0000000E+00 -212.0163     000400
  0.0000000E+00 0.0000000E+00 -413.5822      743.3074     0.0000000E+00 000301
   226.7695      129.4281     0.0000000E+00 0.0000000E+00 -30.26036     000202
  0.0000000E+00 0.0000000E+00 -32.80219      9.686172     0.0000000E+00 000103
  0.4062480     0.1096512     0.0000000E+00 0.0000000E+00 -1.754385     000004
   205859.5     -628.8931     0.0000000E+00 0.0000000E+00 -10632.59     500000
   599148.2      57176.92     0.0000000E+00 0.0000000E+00  3206.590     410000
   847886.2      195486.7     0.0000000E+00 0.0000000E+00  51656.24     320000
   541621.1      202780.5     0.0000000E+00 0.0000000E+00  46859.86     230000
   82690.90      85237.13     0.0000000E+00 0.0000000E+00  10399.25     140000
  -16890.45      10878.99     0.0000000E+00 0.0000000E+00 -24.86644     050000
  0.0000000E+00 0.0000000E+00  1271227.      409089.5     0.0000000E+00 401000
  0.0000000E+00 0.0000000E+00  959344.6      335909.1     0.0000000E+00 311000
  0.0000000E+00 0.0000000E+00 -1282037.     -373120.6     0.0000000E+00 221000
  0.0000000E+00 0.0000000E+00 -997567.2     -337905.0     0.0000000E+00 131000
  0.0000000E+00 0.0000000E+00 -88990.12     -48086.55     0.0000000E+00 041000
  -270622.6     -115453.5     0.0000000E+00 0.0000000E+00 -86279.80     302000
  -324337.5     -128411.9     0.0000000E+00 0.0000000E+00 -38951.94     212000
   1719.837     -12018.23     0.0000000E+00 0.0000000E+00  79964.82     122000
   59938.60      10794.44     0.0000000E+00 0.0000000E+00  31244.77     032000
  0.0000000E+00 0.0000000E+00  839569.8      223778.9     0.0000000E+00 203000
  0.0000000E+00 0.0000000E+00  626768.6      179147.5     0.0000000E+00 113000
  0.0000000E+00 0.0000000E+00  46305.24      25047.76     0.0000000E+00 023000
   14965.43      1714.429     0.0000000E+00 0.0000000E+00 -30932.01     104000
  -3347.388     -1695.947     0.0000000E+00 0.0000000E+00 -11241.07     014000
  0.0000000E+00 0.0000000E+00  18036.43     -948.1405     0.0000000E+00 005000
  0.0000000E+00 0.0000000E+00  1523946.      492331.0     0.0000000E+00 400100
  0.0000000E+00 0.0000000E+00  728923.2      308655.0     0.0000000E+00 310100
  0.0000000E+00 0.0000000E+00 -1649729.     -397693.9     0.0000000E+00 220100
  0.0000000E+00 0.0000000E+00 -826383.7     -256176.7     0.0000000E+00 130100
  0.0000000E+00 0.0000000E+00  1443.127     -21357.35     0.0000000E+00 040100
  -232545.5     -112276.8     0.0000000E+00 0.0000000E+00 -185875.1     301100
  -227189.4     -53115.57     0.0000000E+00 0.0000000E+00  27706.14     211100
   86225.25      48401.78     0.0000000E+00 0.0000000E+00  248092.7     121100
   151737.1      28560.08     0.0000000E+00 0.0000000E+00  74197.74     031100
  0.0000000E+00 0.0000000E+00  2356229.      599069.9     0.0000000E+00 202100
  0.0000000E+00 0.0000000E+00  1654999.      501055.8     0.0000000E+00 112100
  0.0000000E+00 0.0000000E+00  157430.9      102923.7     0.0000000E+00 022100
   273796.7      81915.83     0.0000000E+00 0.0000000E+00 -100182.0     103100
   33937.57      7128.896     0.0000000E+00 0.0000000E+00 -28355.68     013100
  0.0000000E+00 0.0000000E+00  60403.56     -26103.54     0.0000000E+00 004100
  -48978.95     -7222.500     0.0000000E+00 0.0000000E+00  2085.186     400001
  -44840.52     -11594.32     0.0000000E+00 0.0000000E+00  474.1186     310001
   22560.33     -9499.592     0.0000000E+00 0.0000000E+00 -7149.748     220001
   18549.21     -4232.982     0.0000000E+00 0.0000000E+00 -4778.293     130001
   583.6716     -1599.545     0.0000000E+00 0.0000000E+00 -213.2903     040001
  0.0000000E+00 0.0000000E+00 -39038.37     -7442.306     0.0000000E+00 301001
  0.0000000E+00 0.0000000E+00 -97766.97     -21574.07     0.0000000E+00 211001
  0.0000000E+00 0.0000000E+00  38858.26      13204.53     0.0000000E+00 121001
  0.0000000E+00 0.0000000E+00  38111.68      10465.22     0.0000000E+00 031001
   71685.34      18759.40     0.0000000E+00 0.0000000E+00 -2071.606     202001
   49908.57      15463.77     0.0000000E+00 0.0000000E+00  3774.717     112001
   9284.254      4254.941     0.0000000E+00 0.0000000E+00  1262.833     022001
  0.0000000E+00 0.0000000E+00 -36409.30     -18116.41     0.0000000E+00 103001
  0.0000000E+00 0.0000000E+00 -17806.48     -7669.094     0.0000000E+00 013001
   3083.374      2055.374     0.0000000E+00 0.0000000E+00  266.4293     004001
   208627.6      95678.92     0.0000000E+00 0.0000000E+00 -73598.87     300200
   182604.3      175215.2     0.0000000E+00 0.0000000E+00  102231.4     210200
   24679.31      106972.5     0.0000000E+00 0.0000000E+00  169487.4     120200
   87746.18      29763.05     0.0000000E+00 0.0000000E+00  43331.76     030200
  0.0000000E+00 0.0000000E+00  1549900.      385527.3     0.0000000E+00 201200
  0.0000000E+00 0.0000000E+00  1232162.      483584.2     0.0000000E+00 111200
  0.0000000E+00 0.0000000E+00  295665.8      197370.5     0.0000000E+00 021200
   923304.0      302378.2     0.0000000E+00 0.0000000E+00 -60999.99     102200
   182229.0      30866.85     0.0000000E+00 0.0000000E+00  310.7293     012200
  0.0000000E+00 0.0000000E+00  20921.09     -119847.6     0.0000000E+00 003200
  0.0000000E+00 0.0000000E+00 -82039.73     -18042.53     0.0000000E+00 300101
  0.0000000E+00 0.0000000E+00 -51982.80     -8631.905     0.0000000E+00 210101
  0.0000000E+00 0.0000000E+00  126363.0      49069.19     0.0000000E+00 120101
  0.0000000E+00 0.0000000E+00  50165.60      20698.49     0.0000000E+00 030101
   240251.8      59605.97     0.0000000E+00 0.0000000E+00  19939.47     201101
   195087.3      54901.73     0.0000000E+00 0.0000000E+00  25750.98     111101
   64450.39      25344.73     0.0000000E+00 0.0000000E+00  6410.015     021101
  0.0000000E+00 0.0000000E+00 -177701.0     -85470.01     0.0000000E+00 102101
  0.0000000E+00 0.0000000E+00 -62405.75     -34765.38     0.0000000E+00 012101
  -3293.618      6974.506     0.0000000E+00 0.0000000E+00  2713.380     003101
  -858.7979     -777.1925     0.0000000E+00 0.0000000E+00 -381.7598     300002
   856.1090     -1232.763     0.0000000E+00 0.0000000E+00 -403.4953     210002
   1134.943      132.6262     0.0000000E+00 0.0000000E+00  422.0336     120002
   411.8027      536.0182     0.0000000E+00 0.0000000E+00  232.1183     030002
  0.0000000E+00 0.0000000E+00  935.0290     -1148.719     0.0000000E+00 201002
  0.0000000E+00 0.0000000E+00  3856.895      197.5799     0.0000000E+00 111002
  0.0000000E+00 0.0000000E+00 -1001.325     -1339.492     0.0000000E+00 021002
  -16112.78     -4936.678     0.0000000E+00 0.0000000E+00 -1468.759     102002
  -7126.358     -2615.991     0.0000000E+00 0.0000000E+00 -916.3055     012002
  0.0000000E+00 0.0000000E+00  371.2409      536.7394     0.0000000E+00 003002
  0.0000000E+00 0.0000000E+00  309694.5      187762.0     0.0000000E+00 200300
  0.0000000E+00 0.0000000E+00  655125.0      379032.9     0.0000000E+00 110300
  0.0000000E+00 0.0000000E+00  264725.2      193932.6     0.0000000E+00 020300
   1138214.      387603.4     0.0000000E+00 0.0000000E+00  51673.23     101300
   306787.0      31867.20     0.0000000E+00 0.0000000E+00  39451.00     011300
  0.0000000E+00 0.0000000E+00 -57710.78     -199521.0     0.0000000E+00 002300
   210374.1      43610.22     0.0000000E+00 0.0000000E+00  24047.06     200201
   214473.6      50178.10     0.0000000E+00 0.0000000E+00  25876.37     110201
   84022.88      26283.00     0.0000000E+00 0.0000000E+00  11004.25     020201
  0.0000000E+00 0.0000000E+00 -95065.52     -83775.89     0.0000000E+00 101201
  0.0000000E+00 0.0000000E+00  4740.763     -28653.71     0.0000000E+00 011201
  -19514.89      17814.90     0.0000000E+00 0.0000000E+00  5910.406     002201
  0.0000000E+00 0.0000000E+00  25605.38      9495.849     0.0000000E+00 200102
  0.0000000E+00 0.0000000E+00  20366.87      7447.307     0.0000000E+00 110102
  0.0000000E+00 0.0000000E+00  2271.753      2205.847     0.0000000E+00 020102
  -22757.78     -7299.670     0.0000000E+00 0.0000000E+00 -3545.028     101102
  -8246.798     -3370.550     0.0000000E+00 0.0000000E+00 -1393.158     011102
  0.0000000E+00 0.0000000E+00  4011.778      212.6521     0.0000000E+00 002102
  -239.8164      42.93402     0.0000000E+00 0.0000000E+00  77.01081     200003
  -83.14475      59.45467     0.0000000E+00 0.0000000E+00  54.88567     110003
   104.2765      25.97647     0.0000000E+00 0.0000000E+00 -1.675278     020003
  0.0000000E+00 0.0000000E+00 -655.0510     -753.9361     0.0000000E+00 101003
  0.0000000E+00 0.0000000E+00 -414.2486     -266.2238     0.0000000E+00 011003
   603.9015      237.7388     0.0000000E+00 0.0000000E+00  7.717392     002003
   524516.9      189231.5     0.0000000E+00 0.0000000E+00  49444.20     100400
   162186.5      4302.691     0.0000000E+00 0.0000000E+00  29475.16     010400
  0.0000000E+00 0.0000000E+00 -24174.47     -111923.8     0.0000000E+00 001400
  0.0000000E+00 0.0000000E+00  53160.72      17466.83     0.0000000E+00 100301
  0.0000000E+00 0.0000000E+00  41118.21      13296.00     0.0000000E+00 010301
  -15425.06      26542.71     0.0000000E+00 0.0000000E+00  8715.126     001301
   6604.432      1754.657     0.0000000E+00 0.0000000E+00  195.4265     100202
   625.2787      547.8311     0.0000000E+00 0.0000000E+00  520.6480     010202
  0.0000000E+00 0.0000000E+00 -676.8423     -6589.112     0.0000000E+00 001202
  0.0000000E+00 0.0000000E+00 -1204.814     -458.6519     0.0000000E+00 100103
  0.0000000E+00 0.0000000E+00 -575.8461     -209.3115     0.0000000E+00 010103
  -727.2853     -44.67296     0.0000000E+00 0.0000000E+00 -17.81994     001103
   10.94512     -4.455945     0.0000000E+00 0.0000000E+00 -6.412213     100004
   3.662316     -2.278804     0.0000000E+00 0.0000000E+00 -2.859713     010004
  0.0000000E+00 0.0000000E+00 -48.35760     -28.27328     0.0000000E+00 001004
  0.0000000E+00 0.0000000E+00 -23492.97      2088.657     0.0000000E+00 000500
   3557.700      13456.98     0.0000000E+00 0.0000000E+00  6442.822     000401
  0.0000000E+00 0.0000000E+00 -883.1863     -3887.335     0.0000000E+00 000302
  -1115.623     -369.8261     0.0000000E+00 0.0000000E+00  46.68054     000203
  0.0000000E+00 0.0000000E+00  69.26004     -37.76118     0.0000000E+00 000104
 -0.7971318    -0.1188820     0.0000000E+00 0.0000000E+00  1.923537     000005""")

        pp = PhaseSpaceParticle.phase_space_particles_along_positive_ellipse_in_plane(
            PhaseSpaceParticle.XXP_PLANE, 3.5 * MM, 7.5 * MM, 0.1, 5
        )

        apply = map.apply_phase_space_particles(pp, 5)

        self.assertTrue(Equal.equal_float(apply[0].x, 0.003407282903710953))

        pp = PhaseSpaceParticle.phase_space_particles_along_positive_ellipse_in_plane(
            PhaseSpaceParticle.YYP_PLANE, 3.5 * MM, 7.5 * MM, 0.1, 5
        )

        apply = map.apply_phase_space_particles(pp, 5)

        self.assertTrue(Equal.equal_float(apply[1].y, -5.955362189691938E-4))


if __name__ == '__main__':
    unittest.main()
